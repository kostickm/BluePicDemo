{"_id":"_design/main_design","views":{"images":{"map":"function(doc) {\n  //if (doc.type == 'image' && doc.hasOwnProperty('_attachments')) {\n  if (doc.type == 'image') {\n    emit([doc.uploadedTs, doc._id, 0], doc._id);\n    emit([doc.uploadedTs, doc._id, 1], { _id : doc.userId });\n  }\n}"},"users":{"map":"function(doc) {\n  if (doc.type == 'user') {\n    emit(doc._id, doc);\n  }\n}"},"images_per_user":{"map":"function(doc) {\n  //if (doc.type == 'image' && doc.hasOwnProperty('_attachments')) {\n  if (doc.type == 'image') {\n    emit([doc.userId, doc.uploadedTs], doc);\n  }\n}"},"images_by_id":{"map":"function(doc) {\n  //if (doc.type == 'image' && doc.hasOwnProperty('_attachments')) {\n  if (doc.type == 'image') {\n    emit([doc._id, 0], doc._id);\n    emit([doc._id, 1], {_id : doc.userId});\n  }\n}"},"tags":{"reduce":"_sum","map":"function(doc) {\n  if (doc.type == 'image') {\n    var length = doc.tags.length;\n    for (var i=0; i<length; i++) {\n      emit(doc.tags[i].label, 1);\n    }\n  }\n}"},"images_by_tags":{"map":"function(doc) {\n  if (doc.type == 'image') {\n    var length = doc.tags.length;\n    for (var i=0; i<length; i++) {\n      emit([doc.tags[i].label, doc.uploadedTs, doc._id, 0], doc._id);\n      emit([doc.tags[i].label, doc.uploadedTs, doc._id, 1], { _id : doc.userId });\n    }\n  }\n}","reduce":"function (keys, values, rereduce) {\n  if (rereduce) {\n    var result = [ ];\n    for (var i=0; i<values.length; i++) {\n      var entry = values[i];\n      for (var j=0;j<entry.length; j++) {\n        var item = entry[j];\n        result.push(item);\n      }\n    }\n    return result;\n  } else {\n    return values;\n  }\n}"}},"language":"javascript"}
